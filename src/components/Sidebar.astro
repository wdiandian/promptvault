---
interface ModelItem {
  id: string;
  name: string;
  type?: string;
  count?: number;
  isPinned?: boolean;
}

interface Props {
  models: ModelItem[];
  currentModelId?: string;
}

const { models, currentModelId } = Astro.props;

const imageModels = models.filter((m) => m.type !== 'video');
const videoModels = models.filter((m) => m.type === 'video');
const totalCount = models.reduce((sum, m) => sum + (m.count ?? 0), 0);
---

<aside class="w-[220px] fixed top-[52px] bottom-0 left-0 bg-bg-sidebar border-r border-border overflow-y-auto py-4 z-50 max-md:hidden">
  <a
    href="/gallery"
    class:list={[
      'relative flex items-center gap-2 px-4 py-2.5 text-[.875rem] transition-all duration-100 mb-1',
      !currentModelId
        ? 'text-text font-semibold'
        : 'text-text-3 hover:text-text-2 hover:bg-bg-hover',
    ]}
  >
    {!currentModelId && (
      <span class="absolute left-0 top-1.5 bottom-1.5 w-0.5 bg-accent rounded-sm" />
    )}
    <span>All</span>
    <span class="ml-auto text-[.75rem] text-text-3">{totalCount}</span>
  </a>

  {imageModels.length > 0 && (
    <>
      <div class="px-4 text-[.6875rem] font-semibold uppercase tracking-[.05em] text-text-3 mt-4 mb-1.5 flex items-center gap-1.5">
        <svg class="w-3 h-3" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="3" y="3" width="18" height="18" rx="2"/><circle cx="8.5" cy="8.5" r="1.5"/><polyline points="21 15 16 10 5 21"/></svg>
        Image
      </div>
      {imageModels.map((m) => (
        <a
          href={`/gallery?model=${m.id}`}
          class:list={[
            'relative flex items-center gap-2 px-4 py-1.5 text-[.8125rem] transition-all duration-100',
            currentModelId === m.id
              ? 'text-text font-semibold'
              : 'text-text-3 hover:text-text-2 hover:bg-bg-hover',
          ]}
        >
          {currentModelId === m.id && (
            <span class="absolute left-0 top-1 bottom-1 w-0.5 bg-accent rounded-sm" />
          )}
          <span class="truncate">{m.name}</span>
          {(m.count ?? 0) > 0 && (
            <span class="ml-auto text-[.7rem] text-text-3 shrink-0">{m.count}</span>
          )}
        </a>
      ))}
    </>
  )}

  {videoModels.length > 0 && (
    <>
      <div class="px-4 text-[.6875rem] font-semibold uppercase tracking-[.05em] text-text-3 mt-5 mb-1.5 flex items-center gap-1.5">
        <svg class="w-3 h-3" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polygon points="23 7 16 12 23 17 23 7"/><rect x="1" y="5" width="15" height="14" rx="2"/></svg>
        Video
      </div>
      {videoModels.map((m) => (
        <a
          href={`/gallery?model=${m.id}`}
          class:list={[
            'relative flex items-center gap-2 px-4 py-1.5 text-[.8125rem] transition-all duration-100',
            currentModelId === m.id
              ? 'text-text font-semibold'
              : 'text-text-3 hover:text-text-2 hover:bg-bg-hover',
          ]}
        >
          {currentModelId === m.id && (
            <span class="absolute left-0 top-1 bottom-1 w-0.5 bg-accent rounded-sm" />
          )}
          <span class="truncate">{m.name}</span>
          {(m.count ?? 0) > 0 && (
            <span class="ml-auto text-[.7rem] text-text-3 shrink-0">{m.count}</span>
          )}
        </a>
      ))}
    </>
  )}
</aside>
