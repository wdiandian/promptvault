---
interface ModelItem {
  id: string;
  name: string;
  type?: string;
  count?: number;
}

interface Props {
  models: ModelItem[];
  currentModelId?: string;
}

const { models, currentModelId } = Astro.props;

const imageModels = models.filter((m) => m.type !== 'video');
const videoModels = models.filter((m) => m.type === 'video');
const totalCount = models.reduce((sum, m) => sum + (m.count ?? 0), 0);
---

<aside class="w-[220px] fixed top-[52px] bottom-0 left-0 bg-bg-sidebar border-r border-border overflow-y-auto py-4 z-50 max-md:hidden">
  <!-- All -->
  <a
    href="/gallery"
    class:list={[
      'flex items-center gap-2.5 mx-3 px-3 py-2.5 rounded-[8px] text-[.875rem] font-medium transition-all duration-100 mb-2',
      !currentModelId
        ? 'bg-bg-hover text-text font-semibold'
        : 'text-text-2 hover:bg-bg-hover hover:text-text',
    ]}
  >
    <svg class="w-4 h-4 shrink-0 opacity-60" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="3" y="3" width="7" height="7" rx="1"/><rect x="14" y="3" width="7" height="7" rx="1"/><rect x="3" y="14" width="7" height="7" rx="1"/><rect x="14" y="14" width="7" height="7" rx="1"/></svg>
    <span>All</span>
    <span class="ml-auto text-[.75rem] text-text-3 bg-bg px-1.5 py-0.5 rounded-full min-w-[24px] text-center">{totalCount}</span>
  </a>

  <!-- Image Models -->
  {imageModels.length > 0 && (
    <>
      <div class="flex items-center gap-2 px-4 mt-4 mb-2">
        <div class="flex items-center gap-1.5 text-[.6875rem] font-semibold uppercase tracking-[.06em] text-text-3">
          <svg class="w-3.5 h-3.5" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="3" y="3" width="18" height="18" rx="2"/><circle cx="8.5" cy="8.5" r="1.5"/><polyline points="21 15 16 10 5 21"/></svg>
          Image
        </div>
        <div class="flex-1 h-px bg-border"></div>
      </div>
      {imageModels.map((m) => (
        <a
          href={`/gallery?model=${m.id}`}
          class:list={[
            'flex items-center gap-2.5 mx-3 px-3 py-2 rounded-[8px] text-[.8125rem] transition-all duration-100',
            currentModelId === m.id
              ? 'bg-accent-soft text-accent font-semibold'
              : 'text-text-2 hover:bg-bg-hover hover:text-text',
          ]}
        >
          <span class="truncate">{m.name}</span>
          {(m.count ?? 0) > 0 && (
            <span class="ml-auto text-[.7rem] text-text-3 shrink-0">{m.count}</span>
          )}
        </a>
      ))}
    </>
  )}

  <!-- Video Models -->
  {videoModels.length > 0 && (
    <>
      <div class="flex items-center gap-2 px-4 mt-5 mb-2">
        <div class="flex items-center gap-1.5 text-[.6875rem] font-semibold uppercase tracking-[.06em] text-text-3">
          <svg class="w-3.5 h-3.5" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polygon points="23 7 16 12 23 17 23 7"/><rect x="1" y="5" width="15" height="14" rx="2"/></svg>
          Video
        </div>
        <div class="flex-1 h-px bg-border"></div>
      </div>
      {videoModels.map((m) => (
        <a
          href={`/gallery?model=${m.id}`}
          class:list={[
            'flex items-center gap-2.5 mx-3 px-3 py-2 rounded-[8px] text-[.8125rem] transition-all duration-100',
            currentModelId === m.id
              ? 'bg-accent-soft text-accent font-semibold'
              : 'text-text-2 hover:bg-bg-hover hover:text-text',
          ]}
        >
          <span class="truncate">{m.name}</span>
          {(m.count ?? 0) > 0 && (
            <span class="ml-auto text-[.7rem] text-text-3 shrink-0">{m.count}</span>
          )}
        </a>
      ))}
    </>
  )}
</aside>
